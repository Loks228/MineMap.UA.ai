# Нейронная сеть для распознавания мин и взрывоопасных предметов

Этот проект использует глубокое обучение для распознавания и классификации мин и других взрывоопасных предметов на фотографиях с оценкой уровня опасности.

## Возможности

- Классификация изображений на опасные (мины, взрывчатка) и безопасные
- Оценка вероятности опасности в процентах (0-100%)
- Визуализация результатов с цветовой индикацией
- Два режима работы: обучение (на мощном компьютере) и инференс (на слабом ноутбуке)

## Структура проекта

- `model.py` - архитектура нейронной сети
- `train.py` - скрипт для обучения модели
- `predict.py` - скрипт для предсказаний (может запускаться на слабом компьютере)
- `requirements.txt` - зависимости Python

## Подготовка данных

Для обучения модели требуется набор данных следующей структуры:

```
data/
  ├── dangerous/
  │   ├── mine1.jpg
  │   ├── mine2.jpg
  │   └── ...
  └── safe/
      ├── rock1.jpg
      ├── trash1.jpg
      └── ...
```

## Установка зависимостей

```bash
pip install -r requirements.txt
```

## Обучение модели

Запустите обучение на мощном компьютере (желательно с GPU):

```bash
python train.py --data путь/к/вашим/данным --output model.h5
```

Дополнительные параметры:
- `--epochs` - количество эпох обучения (по умолчанию 20)
- `--batch_size` - размер батча (по умолчанию 32)

## Использование для предсказаний

После обучения модель можно использовать на слабом компьютере для анализа новых изображений:

```bash
python predict.py --model путь/к/модели.h5 --image путь/к/изображению.jpg
```

Результат включает:
- Отображение изображения с оценкой
- Статус (ОПАСНО/ТРЕБУЕТ ПРОВЕРКИ/БЕЗОПАСНО)
- Процент вероятности опасности
- Сохранение результата в файл

## Технические детали

Модель основана на архитектуре EfficientNetB0 с предобучением на ImageNet. Используется transfer learning с fine-tuning верхних слоев. Для повышения обобщающей способности модели применяется аугментация данных.

## Требования к системе

Для обучения:
- Python 3.7+
- GPU с поддержкой CUDA (рекомендуется)
- 8GB RAM минимум

Для предсказаний:
- Python 3.7+
- CPU (GPU не обязателен)
- 4GB RAM минимум 